import{a as n}from"./app.7a437beb.js";import{_ as a}from"./plugin-vue_export-helper.21dcd24c.js";const s={},t=n(`<h1 id="dynamic-templates" tabindex="-1"><a class="header-anchor" href="#dynamic-templates" aria-hidden="true">#</a> Dynamic Templates</h1><nav class="table-of-contents"><ul></ul></nav><p>This document explores how to render templates dynamically from within the component based on received data or user input.</p><p>In muban, ideally all HTML is rendered on the server, where muban components will just make things interactive. This means that rendering HTML from JS is not the core part of muban.</p><p>However, there are cases where we want to &quot;render&quot; something from JS:</p><ul><li>When having a list of tiles, and we want to change the sorting or do local filtering, we need to take those existing items, and (conditionally) hide them or move them around.</li><li>When having a list of tiles, and we have a &quot;load more&quot; button to load more content, and the API returns structured JSON data instead of plain HTML, we need to use that to render more items.</li><li>Or a combination of the above, when sorting/filtering happens in the API, and we received back structured data.</li><li>When searching, and we receive the results as structured data from the API.</li></ul><p>There are a few different (technical) scenarios related to the above, so let&#39;s explore them:</p><ol><li><p>In most cases, the templates that we need to render on the client, are also used to render those same items from the CMS. (e.g. load more) In other cases, some tiles are client-only. It&#39;s best to treat those templates exactly the same, and don&#39;t have a different syntax or mechanism to render each use case.</p><p>Something to always keep in mind is that when rendering templates from the client, they should always be kept up-to-date with the CMS templates.</p></li><li><p>In some cases (like with client side filtering/sorting), the DOM elements already exist with the right data, so we don&#39;t <em>need</em> to render them again, just hide/move them in the DOM. However, to execute any client side logic on those items, we need to extract the data first, which leaves us in the same place as the API use case - structured data that needs to be rendered (again).</p><p>If we have a solid way of extracting all data from those items as a separate step, we can then continue from there the same way as the API use case.</p></li></ol><p>So, what do we actually need to render dynamic templates from within a component?</p><ul><li>We need to have data, and know when it changes - so it should be defined as a binding, linked to an observable object</li><li>We need to have a container where to render it in.</li><li>If we go based on data, we have no way to make &quot;append&quot; mode work</li><li>We need a template to render <ul><li>This template can be a single item/component we pass data to</li><li>Or it can be for a list, and contains the loop and wrapping logic to render multiple items</li></ul></li></ul><p>Potential solutions could look like:</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// item template</span>
<span class="token keyword">type</span> <span class="token class-name">ItemTemplateProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">itemTemplate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> title <span class="token punctuation">}</span><span class="token operator">:</span> ItemTemplateProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;div&gt;
    &lt;p&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
  &lt;/div&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// list template</span>

<span class="token keyword">type</span> <span class="token class-name">ListTemplateProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span> items<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>ItemTemplateProps<span class="token operator">&gt;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">listTemplate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token operator">:</span> ListTemplateProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;div&gt;
    &lt;ul&gt;
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> html<span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;li&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token function">itemTemplate</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    &lt;ul&gt;
  &lt;/div&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// store the items to render</span>
<span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// config to extract the data from the already rendered HTML</span>
<span class="token keyword">const</span> extractOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  config<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// when extracted, add the data to the items array</span>
  <span class="token function-variable function">onData</span><span class="token operator">:</span> data <span class="token operator">=&gt;</span> items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// set up dynamic template rendering</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refs.listContainer</span> <span class="token attr-name">extract</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>extractOptions<span class="token punctuation">}</span></span> <span class="token attr-name">data</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> items <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">template</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>listTemplate<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">// or</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Template</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>refs<span class="token punctuation">.</span>listContainer<span class="token punctuation">}</span></span> <span class="token attr-name">extract</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>extractOptions<span class="token punctuation">}</span></span> <span class="token attr-name">data</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> items <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">template</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>listTemplate<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div>`,12);function e(p,o){return t}var i=a(s,[["render",e]]);export{i as default};
