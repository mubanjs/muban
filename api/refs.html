<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Refs | Muban</title><meta name="description" content="Writing components for server-rendered HTML">
    <link rel="modulepreload" href="/muban/assets/app.7a437beb.js"><link rel="modulepreload" href="/muban/assets/refs.html.379c3ddb.js"><link rel="modulepreload" href="/muban/assets/refs.html.81539ca1.js"><link rel="modulepreload" href="/muban/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/muban/assets/style.f8dfe95e.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/muban/" class=""><!----><span class="site-name">Muban</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/muban/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/guide/" class="" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/api/" class="router-link-active" aria-label="Api"><!--[--><!--]--> Api <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/changelog/" class="" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/research/" class="" aria-label="Research"><!--[--><!--]--> Research <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/mubanjs/muban" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/muban/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/guide/" class="" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/api/" class="router-link-active" aria-label="Api"><!--[--><!--]--> Api <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/changelog/" class="" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/muban/research/" class="" aria-label="Research"><!--[--><!--]--> Research <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/mubanjs/muban" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a aria-current="page" href="/muban/api/refs.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="Refs"><!--[--><!--]--> Refs <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/muban/api/refs.html#ref-definition" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ref definition"><!--[--><!--]--> Ref definition <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/muban/api/refs.html#refelement" class="router-link-active router-link-exact-active sidebar-item" aria-label="refElement"><!--[--><!--]--> refElement <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/muban/api/refs.html#refcollection" class="router-link-active router-link-exact-active sidebar-item" aria-label="refCollection"><!--[--><!--]--> refCollection <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/muban/api/refs.html#refcomponent" class="router-link-active router-link-exact-active sidebar-item" aria-label="refComponent"><!--[--><!--]--> refComponent <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/muban/api/refs.html#refcomponents" class="router-link-active router-link-exact-active sidebar-item" aria-label="refComponents"><!--[--><!--]--> refComponents <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/muban/api/refs.html#ref-item" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ref item"><!--[--><!--]--> Ref item <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/muban/api/app.html" class="sidebar-item sidebar-heading" aria-label="App"><!--[--><!--]--> App <!--[--><!--]--></a><!----></li><li><a href="/muban/api/component.html" class="sidebar-item sidebar-heading" aria-label="Component"><!--[--><!--]--> Component <!--[--><!--]--></a><!----></li><li><a href="/muban/api/props.html" class="sidebar-item sidebar-heading" aria-label="Props"><!--[--><!--]--> Props <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/muban/api/refs.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="Refs"><!--[--><!--]--> Refs <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/muban/api/refs.html#ref-definition" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ref definition"><!--[--><!--]--> Ref definition <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/muban/api/refs.html#refelement" class="router-link-active router-link-exact-active sidebar-item" aria-label="refElement"><!--[--><!--]--> refElement <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/muban/api/refs.html#refcollection" class="router-link-active router-link-exact-active sidebar-item" aria-label="refCollection"><!--[--><!--]--> refCollection <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/muban/api/refs.html#refcomponent" class="router-link-active router-link-exact-active sidebar-item" aria-label="refComponent"><!--[--><!--]--> refComponent <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/muban/api/refs.html#refcomponents" class="router-link-active router-link-exact-active sidebar-item" aria-label="refComponents"><!--[--><!--]--> refComponents <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/muban/api/refs.html#ref-item" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ref item"><!--[--><!--]--> Ref item <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/muban/api/bindings.html" class="sidebar-item sidebar-heading" aria-label="Bindings"><!--[--><!--]--> Bindings <!--[--><!--]--></a><!----></li><li><a href="/muban/api/hooks.html" class="sidebar-item sidebar-heading" aria-label="Hooks"><!--[--><!--]--> Hooks <!--[--><!--]--></a><!----></li><li><a href="/muban/api/provide-inject.html" class="sidebar-item sidebar-heading" aria-label="Provide / Inject"><!--[--><!--]--> Provide / Inject <!--[--><!--]--></a><!----></li><li><a href="/muban/api/mhtml.html" class="sidebar-item sidebar-heading" aria-label="mhtml templates"><!--[--><!--]--> mhtml templates <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="refs" tabindex="-1"><a class="header-anchor" href="#refs" aria-hidden="true">#</a> Refs</h1><p>Refs have two stages, the definitions - which go inside your component definition, and the resolved items - which you receive in your setup function, and use for bindings.</p><h2 id="ref-definition" tabindex="-1"><a class="header-anchor" href="#ref-definition" aria-hidden="true">#</a> Ref definition</h2><p>The shape of the definition that you pass to the component is the following:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// refs definition</span>
<span class="token keyword">type</span> <span class="token class-name">ComponentRefItem</span> <span class="token operator">=</span>
  <span class="token comment">// shortcut for element ref, will internally be turned into a `refElement()`</span>
  <span class="token operator">|</span> <span class="token builtin">string</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span>
      <span class="token comment">// Different refs have their own type, to execute slightly different logic on them.</span>
      type<span class="token operator">:</span> <span class="token string">&#39;element&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;collection&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;component&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;componentCollection&#39;</span><span class="token punctuation">;</span>
      <span class="token comment">// The value of the `data-ref` attribute on the html element(s).</span>
      ref<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
      <span class="token comment">// Only used for element/component, and when true, it will log an error if the element</span>
      <span class="token comment">// doesn&#39;t exist in the DOM. Nothing will break, it&#39;s just that the bindings will not</span>
      <span class="token comment">// be executed.</span>
      isRequired<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
      <span class="token comment">// A function that will find the right HTMLElement(s) that should be used for the refs.</span>
      <span class="token comment">// When `type` is element or component, it returns a single HTMLElement or null.</span>
      <span class="token function-variable function">queryRef</span><span class="token operator">:</span> <span class="token punctuation">(</span>parent<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> HTMLElement <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>However, you would never pass this by hand, but instead make use of the available helper functions described below.</p><p><strong>ignoreGuard</strong></p><p>By default, only refs directly within a component can be selected. Refs from child components are not accessible. All <code>ref</code> functions have an <code>ignoreGuard</code> option.</p><p>When setting <code>ignoreGuard</code> to true, it disables the guarding behaviour, and allows you to query any ref.</p><h3 id="refelement" tabindex="-1"><a class="header-anchor" href="#refelement" aria-hidden="true">#</a> refElement</h3><p><code>refElement</code> selects a single DOM element that has the <code>data-ref</code> attribute set.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">refElement</span><span class="token punctuation">(</span>
  refIdOrQuery<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>parent<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> HTMLElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    isRequired<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    ignoreGuard<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ComponentRefItemElement<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="refidorquery" tabindex="-1"><a class="header-anchor" href="#refidorquery" aria-hidden="true">#</a> refIdOrQuery</h4><p><code>refId: string</code></p><p><code>refQuery: (parent: HTMLElement) =&gt; HTMLElement | null)</code></p><p>When passing a <code>string</code>, it&#39;s the value of the <code>data-ref</code> attribute on one of the HTMLElements in the DOM.</p><p>When passing a <code>function</code>, you can query your elements by using <code>parent.querySelector(...)</code> to return a single element.</p><p>Any elements that are queried are filtered against the component guard unless <code>options. ignoreGuard</code> is set to <code>true</code>.</p><h4 id="options-isrequired" tabindex="-1"><a class="header-anchor" href="#options-isrequired" aria-hidden="true">#</a> options.isRequired</h4><p><code>isRequired?: boolean = true</code></p><p>By default, all refs are marked as <strong>required</strong>, and will log errors in the console when they cannot be found. If elements are optional, you can set <code>isRequired</code> to <code>false</code>, and by doing that, the type becomes optional as well.</p><h4 id="options-ignoreguard" tabindex="-1"><a class="header-anchor" href="#options-ignoreguard" aria-hidden="true">#</a> options.ignoreGuard</h4><p><code>ignoreGuard?: boolean = false</code></p><p>When set to <code>true</code>, it disables the guarding behaviour, and allows you to query any ref of any child component.</p><p><strong>Example</strong></p><!----><div class="custom-container tip"><p class="custom-container-title">Shortcut</p><p>Passing <code>&#39;string&#39;</code> is a quick shortcut for <code>refElement(&#39;string&#39;)</code>.</p></div><h3 id="refcollection" tabindex="-1"><a class="header-anchor" href="#refcollection" aria-hidden="true">#</a> refCollection</h3><p><code>refCollection</code> selects one or more DOM elements that have the <code>data-ref</code> attribute set. If no elements are found, the collection will be empty.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">refCollection</span><span class="token punctuation">(</span>
  refIdOrQuery<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>parent<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    minimumItemsRequired<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    ignoreGuard<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ComponentRefItemCollection<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>In the <code>setup</code> function, a collection can be used to apply the same binding to multiple items, or to loop over in a mapping function and specify a different binding based on each individual element or index in the collection.</p><h4 id="refidorquery-1" tabindex="-1"><a class="header-anchor" href="#refidorquery-1" aria-hidden="true">#</a> refIdOrQuery</h4><p><code>refId: string</code></p><p><code>refQuery: (parent: HTMLElement) =&gt; Array&lt;HTMLElement&gt;)</code></p><p>When passing a <code>string</code>, it&#39;s the value of the <code>data-ref</code> attribute on one or multiple HTMLElements in the DOM.</p><p>When passing a <code>function</code>, you can query your elements by using <code>parent.querySelectorAll(...)</code> to return one or multiple elements.</p><p>Any elements that are queried are filtered against the component guard unless <code>options. ignoreGuard</code> is set to <code>true</code>.</p><h4 id="options-minimumitemsrequired" tabindex="-1"><a class="header-anchor" href="#options-minimumitemsrequired" aria-hidden="true">#</a> options.minimumItemsRequired</h4><p><code>minimumItemsRequired?: number = 0</code></p><p>By default, the returned collection can be empty, and is thus optional by default. By setting <code>minimumItemsRequired</code> to a specific value, an error is thrown when the collection contains fewer items.</p><h4 id="options-ignoreguard-1" tabindex="-1"><a class="header-anchor" href="#options-ignoreguard-1" aria-hidden="true">#</a> options.ignoreGuard</h4><p><code>ignoreGuard?: boolean = false</code></p><p>When set to <code>true</code>, it disables the guarding behaviour, and allows you to query any ref of any child component.</p><p><strong>Example</strong></p><!----><h3 id="refcomponent" tabindex="-1"><a class="header-anchor" href="#refcomponent" aria-hidden="true">#</a> refComponent</h3><p><code>refComponent</code> selects a single DOM element that either has the <code>data-component</code> attribute match the one from the passed Component, or has the <code>data-ref</code> attribute set when that is provided in the options.</p><p>After selecting the DOM element, it will create a new component instance for that element.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">refComponent</span><span class="token punctuation">(</span>
  component<span class="token operator">:</span> ComponentFactory <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>ComponentFactory<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    ref<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>parent<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> HTMLElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    isRequired<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    ignoreGuard<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ComponentRefItemComponent<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="component" tabindex="-1"><a class="header-anchor" href="#component" aria-hidden="true">#</a> component</h4><p><code>component: ComponentFactory | Array&lt;ComponentFactory&gt;</code></p><p>One or multiple components that will be created for this ref. In addition to almost all HTML bindings, a component ref also allows you to bind against child component props, updating their values when things change, or providing callback functions that can be called.</p><p>If <code>options.refIdOrQuery</code> is not passed, it will search for the first occurrence of the <code>data-component</code> matching the passed component(s).</p><p>If you pass an <code>Array</code> of multiple components, it will use the first one it finds. The most common use case is by having one element with a specific <code>data-ref</code> that should match one of the passed components.</p><p>When doing that, only the component props that exists on all the passed components can be used to bind against.</p><h4 id="options-ref" tabindex="-1"><a class="header-anchor" href="#options-ref" aria-hidden="true">#</a> options.ref</h4><p><code>ref: string</code></p><p><code>ref: (parent: HTMLElement) =&gt; HTMLElement | null)</code></p><p>If you have multiple component elements, and the ref should target a specific one, the <code>ref</code> can be used. Or if you just want to be more strict about things, to make sure it doesn&#39;t break in the future. Otherwise, if you just have a single child component, you can omit the ref, and it still will be able to find the element based on the <code>data-component</code> attribute.</p><p>When passing a <code>string</code>, it&#39;s the value of the <code>data-ref</code> attribute on one of the HTMLElements in the DOM.</p><p>When passing a <code>function</code>, you can query your elements by using <code>parent.querySelector(...)</code> to return a single element.</p><p>Any elements that are queried are filtered against the component guard unless <code>options. ignoreGuard</code> is set to <code>true</code>.</p><p>Any elements that are queried are also filtered with the <code>data-component</code> attribute against the <code>displayName</code> of the passed <code>ComponentFactory</code>.</p><h4 id="options-isrequired-1" tabindex="-1"><a class="header-anchor" href="#options-isrequired-1" aria-hidden="true">#</a> options.isRequired</h4><p><code>isRequired?: boolean = true</code></p><p>By default, all refs are marked as <strong>required</strong>, and will log errors in the console when they cannot be found. If elements are optional, you can set <code>isRequired</code> to <code>false</code>, and by doing that, the type becomes optional as well.</p><h4 id="options-ignoreguard-2" tabindex="-1"><a class="header-anchor" href="#options-ignoreguard-2" aria-hidden="true">#</a> options.ignoreGuard</h4><p><code>ignoreGuard?: boolean = false</code></p><p>When set to <code>true</code>, it disables the guarding behaviour, and allows you to query any ref of any child component.</p><p><strong>Example</strong></p><!----><h3 id="refcomponents" tabindex="-1"><a class="header-anchor" href="#refcomponents" aria-hidden="true">#</a> refComponents</h3><p><code>refComponents</code> selects one or more DOM elements that either have the <code>data-component</code> attribute match the one from the passed Component, or have the <code>data-ref</code> attribute set when that is provided in the options. If no elements are found, the collection will be empty.</p><p>After selecting the DOM elements, it will create a new component instance for each of them.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">refComponents</span><span class="token punctuation">(</span>
  component<span class="token operator">:</span> ComponentFactory<span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    ref<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>parent<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>TMLElement<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    minimumItemsRequired<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    ignoreGuard<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ComponentRefItemComponentCollection<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="component-1" tabindex="-1"><a class="header-anchor" href="#component-1" aria-hidden="true">#</a> component</h4><p><code>component: ComponentFactory</code></p><p>The component that will be created for this ref. In addition to almost all HTML bindings, a component ref also allows you to bind against child component props, updating their values when things change, or providing callback functions that can be called.</p><p>If <code>options.ref</code> is not passed, it will search for the first occurrence of the <code>data-component</code> matching the passed component.</p><h4 id="options-ref-1" tabindex="-1"><a class="header-anchor" href="#options-ref-1" aria-hidden="true">#</a> options.ref</h4><p><code>ref: string</code></p><p><code>ref: (parent: HTMLElement) =&gt; HTMLElement | null)</code></p><p>If you have multiple component elements, and the ref should target specific ones, the <code>ref</code> can be used. Or if you just want to be more strict about things, to make sure it doesn&#39;t break in the future. Otherwise, if you just want to target all elements of this component, you can omit the ref, and it still will use all element based on the <code>data-component</code> attribute.</p><p>When passing a <code>string</code>, it&#39;s the value of the <code>data-ref</code> attribute on the HTMLElements in the DOM.</p><p>When passing a <code>function</code>, you can query your elements by using <code>parent.querySelectorAll(...)</code> to return multiple elements.</p><p>Any elements that are queried are filtered against the component guard unless <code>options. ignoreGuard</code> is set to <code>true</code>.</p><p>Any elements that are queried are also filtered with the <code>data-component</code> attribute against the <code>displayName</code> of the passed <code>ComponentFactory</code>.</p><h4 id="options-minimumitemsrequired-1" tabindex="-1"><a class="header-anchor" href="#options-minimumitemsrequired-1" aria-hidden="true">#</a> options.minimumItemsRequired</h4><p><code>minimumItemsRequired?: number = 0</code></p><p>By default, the returned collection can be empty, and is thus optional by default. By setting <code>minimumItemsRequired</code> to a specific value, an error is thrown when the collection contains fewer items.</p><h4 id="options-ignoreguard-3" tabindex="-1"><a class="header-anchor" href="#options-ignoreguard-3" aria-hidden="true">#</a> options.ignoreGuard</h4><p><code>ignoreGuard?: boolean = false</code></p><p>When set to <code>true</code>, it disables the guarding behaviour, and allows you to query any ref of any child component.</p><p><strong>Example</strong></p><!----><h2 id="ref-item" tabindex="-1"><a class="header-anchor" href="#ref-item" aria-hidden="true">#</a> Ref item</h2><p>Ref items are &quot;container objects&quot; around the resolved ref definitions to be used in the <code>setup</code> function of the component.</p><p>They are mainly used in the different binding helpers, but contains some additional information about the specific refs that could be useful in some situations.</p><p>The <code>type</code> of each <code>ref</code> is inferred from the input you pass, so the properties you can access is different between elements and components, or single items vs collections.</p><p>The public API for each type of ref can be seen below (note that some internal fields have been omitted here).</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">ElementRef</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  element<span class="token operator">:</span> HTMLElement <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">CollectionRef<span class="token operator">&lt;</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// this is a function, and has refs inside, so causes `watch` or `watchEffect` to re-execute </span>
  <span class="token comment">// when the DOM updates and the items inside the collection change </span>
  <span class="token function-variable function">getElements</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">// nested refs for each single individual element</span>
  <span class="token function-variable function">getRefs</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>ElementRef<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">ComponentRef</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  component<span class="token operator">:</span> ComponentApi <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">ComponentsRef</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// this is a function, and has refs inside, so causes `watch` or `watchEffect` to re-execute </span>
  <span class="token comment">// when the DOM updates and the items inside the collection change </span>
  <span class="token function-variable function">getComponents</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>ComponentApi<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">// nested refs for each single individual component</span>
  <span class="token function-variable function">getRefs</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>ComponentRef<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>As you can see, all 4 have a reference to the actual item(s) that they have selected as <code>element</code>, <code>getElements()</code>, <code>component</code> or <code>getComponents()</code>. The two collection refs have access to the &quot;item&quot; <code>refs</code>, a list of &quot;container refs&quot; around each item in the collection, which could be useful when applying the individual bindings to each item.</p><p><strong>Example</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  refs<span class="token operator">:</span> <span class="token punctuation">{</span>
    singleElement<span class="token operator">:</span> <span class="token function">refElement</span><span class="token punctuation">(</span><span class="token string">&#39;single-element&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    elementCollection<span class="token operator">:</span> <span class="token function">refCollection</span><span class="token punctuation">(</span><span class="token string">&#39;element-collection&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    singleComponent<span class="token operator">:</span> <span class="token function">refElement</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token string">&#39;single-element&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    componentCollection<span class="token operator">:</span> <span class="token function">refElement</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> <span class="token string">&#39;element-collection&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">{</span> props<span class="token punctuation">,</span> refs <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    refs<span class="token punctuation">.</span>singleElement<span class="token punctuation">.</span>element<span class="token punctuation">;</span> <span class="token comment">// HTMLElement</span>
    refs<span class="token punctuation">.</span>elementCollection<span class="token punctuation">.</span><span class="token function">getElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Array&lt;HTMLElement&gt;</span>

    refs<span class="token punctuation">.</span>singleComponent<span class="token punctuation">.</span>component<span class="token punctuation">;</span> <span class="token comment">// ComponentApi</span>
    refs<span class="token punctuation">.</span>singleComponent<span class="token punctuation">.</span>component<span class="token punctuation">.</span>props<span class="token punctuation">;</span> <span class="token comment">// Access the component props, useful for intial state</span>
    refs<span class="token punctuation">.</span>componentCollection<span class="token punctuation">.</span><span class="token function">getComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Array&lt;ComponentApi&gt;</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
      <span class="token function">bind</span><span class="token punctuation">(</span>refs<span class="token punctuation">.</span>singleElement<span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&#39;label&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// bind to single element</span>
      <span class="token function">bind</span><span class="token punctuation">(</span>refs<span class="token punctuation">.</span>elementCollection<span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&#39;label&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// bind to all elements in the collection</span>
      
      <span class="token comment">// bind to each ref individually</span>
      <span class="token operator">...</span>refs<span class="token punctuation">.</span>elementCollection<span class="token punctuation">.</span>refs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">bind</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// but simpler</span>
      <span class="token operator">...</span><span class="token function">bindMap</span><span class="token punctuation">(</span>refs<span class="token punctuation">.</span>elementCollection<span class="token punctuation">,</span> <span class="token punctuation">(</span>ref<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      

      <span class="token comment">// bind to single component, or to all components int the collection</span>
      <span class="token function">bind</span><span class="token punctuation">(</span>refs<span class="token punctuation">.</span>component<span class="token punctuation">,</span> <span class="token punctuation">{</span> someProps<span class="token operator">:</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span> <span class="token function-variable function">onSomethingHappens</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Yo&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">bind</span><span class="token punctuation">(</span>refs<span class="token punctuation">.</span>elementCollection<span class="token punctuation">,</span> <span class="token punctuation">{</span> someProps<span class="token operator">:</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span> <span class="token function-variable function">onSomethingHappens</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Yo&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      
      <span class="token comment">// bind to each ref individually</span>
      <span class="token operator">...</span>refs<span class="token punctuation">.</span>singleComponent<span class="token punctuation">.</span>refs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">bind</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">{</span> itemIndex<span class="token operator">:</span> index <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// but simpler</span>
      <span class="token operator">...</span><span class="token function">bindMap</span><span class="token punctuation">(</span>refs<span class="token punctuation">.</span>componentCollection<span class="token punctuation">,</span> <span class="token punctuation">(</span>ref<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> itemIndex<span class="token operator">:</span> index <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/mubanjs/muban/edit/main/docs/api/refs.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: thanarie@gmail.com">Arjan van Wijk</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><!----><span class="next"><a href="/muban/api/app.html" class="" aria-label="App"><!--[--><!--]--> App <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/muban/assets/app.7a437beb.js" defer></script>
  </body>
</html>
